let app=angular.module("app",["ngRoute"]);angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc",function(t,o){t.$on("login",(function(o,n){t.currentUser=n})),t.logout=function(){t.currentUser=null,o.logout()}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(t,o){t.login=function(n,e){o.login(n,e).then((function(o){t.$emit("login",o.data)}))}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(t,o){t.addPost=function(){t.postBody&&o.create({username:"dickeyxxx",body:t.postBody}).success((function(){t.postBody=null}))},t.$on("ws:new_post",(function(o,n){t.$apply((function(){t.posts.unshift(n)}))})),o.fetch().success((function(o){t.posts=o}))}]),angular.module("app").service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/api/posts")},this.create=function(o){return t.post("/api/posts",o)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(t,o){t.register=function(n,e){o.createUser(n,e).then((function(o){t.$emit("login",o.data)}))}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(t){let o=this;o.getUser=function(){return t.get("/api/users")},o.login=function(n,e){return t.post("/api/sessions",{username:n,password:e}).then((function(n){return t.defaults.headers.common["X-Auth"]=n.data,o.getUser()}))},o.logout=function(){t.defaults.headers.common["X-Auth"]=null},o.createUser=function(n,e){return t.post("/api/users",{username:n,password:e}).then((function(t){return console.log(t),o.login(n,e)}))}}]),angular.module("app").service("WebSocketSvc",["$rootScope",function(t){let o;this.connect=function(){(o=new WebSocket("https:"===window.location.protocol?"wss://"+window.location.host:"ws://"+window.location.host)).onmessage=function(o){const n=JSON.parse(o.data);t.$broadcast("ws:"+n.topic,n.data)}},this.send=function(t,n){const e=JSON.stringify({topic:t,data:n});o.send(e)}}]).run(["WebSocketSvc",function(t){t.connect()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJVc2VyU3ZjIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsImxvZ291dCIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRoZW4iLCJyZXNwb25zZSIsIiRlbWl0IiwiZGF0YSIsIlBvc3RzU3ZjIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwiYm9keSIsInN1Y2Nlc3MiLCJwb3N0IiwiJGFwcGx5IiwicG9zdHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwicmVnaXN0ZXIiLCJjcmVhdGVVc2VyIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJnZXRVc2VyIiwidmFsIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwiY29uc29sZSIsImxvZyIsIiRyb290U2NvcGUiLCJjb25uZWN0aW9uIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIndpbmRvdyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJob3N0Iiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ2lmeSIsInJ1biIsIldlYlNvY2tldFN2YyJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBQUEsSUFBQUMsUUFBQUMsT0FBQSxNQUFBLENBQ0EsWUNEQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGtCQUFBLENBQUEsU0FBQSxVQUFB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LFNBQUFELEVBQUE1QyxHQUNBLE1BQUE4QyxFQUFBTCxLQUFBTSxVQUFBLENBQUFILE1BQUFBLEVBQUE1QyxLQUFBQSxJQUNBK0IsRUFBQWMsS0FBQUMsT0FFQUUsSUFBQSxDQUFBLGVBQUEsU0FBQUMsR0FDQUEsRUFBQWpCIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHRcdCduZ1JvdXRlJ1xuXHRdKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXJTdmMpe1xuXHQkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpe1xuXHRcdCRzY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG5cdH0pO1xuXHRcblx0JHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcblx0XHRVc2VyU3ZjLmxvZ291dCgpO1xuXHR9O1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjKXtcblx0JHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcblx0XHRVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXsgXG5cdFx0XHRcdCRzY29wZS4kZW1pdCgnbG9naW4nLCByZXNwb25zZS5kYXRhKTsgXG5cdFx0XHR9KVxuXHR9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBQb3N0c1N2Yykge1xuXHQkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uICgpe1xuXHRcdGlmKCRzY29wZS5wb3N0Qm9keSl7XG5cdFx0XHRQb3N0c1N2Yy5jcmVhdGUoe1xuXHRcdFx0XHR1c2VybmFtZTogJ2RpY2tleXh4eCcsXG5cdFx0XHRcdGJvZHk6ICRzY29wZS5wb3N0Qm9keVx0XG5cdFx0XHR9KS5zdWNjZXNzKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCRzY29wZS5wb3N0Qm9keSA9IG51bGw7XG5cdFx0XHR9KVxuXHRcdH1cblx0fTtcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KXtcblx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG5cdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcblx0XHR9KVxuXHR9KVxuXG5cdFBvc3RzU3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbihwb3N0cykge1xuXHRcdCRzY29wZS5wb3N0cyA9IHBvc3RzO1xuXHR9KTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApIHtcblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdH1cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KSB7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLCBwb3N0KTtcblx0fVxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjKXtcblx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcblx0XHRVc2VyU3ZjLmNyZWF0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpeyBcblx0XHRcdFx0JHNjb3BlLiRlbWl0KCdsb2dpbicsIHJlc3BvbnNlLmRhdGEpOyBcblx0XHRcdH0pXG5cdH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlcil7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdC53aGVuKCcvJywgeyBjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ30pXG5cdC53aGVuKCcvcmVnaXN0ZXInLCB7IGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLCB0ZW1wbGF0ZVVybDogJ3JlZ2lzdGVyLmh0bWwnfSlcblx0LndoZW4oJy9sb2dpbicsIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnbG9naW4uaHRtbCd9KVxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uKCRodHRwKXtcblx0bGV0IHN2YyA9IHRoaXM7XG5cdFxuXHRzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpXG5cdH1cblxuXHRzdmMubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuXHRcdFx0dXNlcm5hbWU6IHVzZXJuYW1lLFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0fSkudGhlbihmdW5jdGlvbih2YWwpe1xuXHRcdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gdmFsLmRhdGE7XG5cdFx0XHRyZXR1cm4gc3ZjLmdldFVzZXIoKTtcblx0XHR9KTtcblx0fVxuXHRzdmMubG9nb3V0ID0gZnVuY3Rpb24oKXtcblx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSBudWxsO1xuXHR9O1xuXHRzdmMuY3JlYXRlVXNlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG5cdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsXG5cdFx0XHRwYXNzd29yZDogcGFzc3dvcmRcblx0XHR9KS50aGVuKGZ1bmN0aW9uKHZhbCl7XG5cdFx0XHRjb25zb2xlLmxvZyh2YWwpO1xuXHRcdFx0cmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpO1xuXHRcdH0pO1xuXHR9XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1dlYlNvY2tldFN2YycsIGZ1bmN0aW9uKCRyb290U2NvcGUpe1xuXHRmdW5jdGlvbiB3ZWJzb2NrZXRIb3N0KCl7XG5cdFx0aWYod2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSBcImh0dHBzOlwiKXtcblx0XHRcdHJldHVybiBcIndzczovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3Q7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBcIndzOi8vXCIgKyB3aW5kb3cubG9jYXRpb24uaG9zdDtcblx0XHR9XG5cdH1cblx0bGV0IGNvbm5lY3Rpb247IFxuXHR0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbigpe1xuXHRcdGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHdlYnNvY2tldEhvc3QoKSk7XG5cdFx0Y29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKXtcblx0XHRcdGNvbnN0IHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cdFx0XHQkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpO1xuXHRcdH1cblx0fVxuXHR0aGlzLnNlbmQgPSBmdW5jdGlvbih0b3BpYywgZGF0YSkge1xuXHRcdGNvbnN0IGpzb24gPSBKU09OLnN0cmluZ2lmeSh7dG9waWM6IHRvcGljLCBkYXRhOiBkYXRhfSk7XG5cdFx0Y29ubmVjdGlvbi5zZW5kKGpzb24pO1xuXHR9XG59KS5ydW4oZnVuY3Rpb24gKFdlYlNvY2tldFN2Yyl7XG5cdFdlYlNvY2tldFN2Yy5jb25uZWN0KCk7XG59KSJdfQ==
